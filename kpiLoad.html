<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>KPI Sheet Uploader</title>
  <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    h2 { margin-top: 40px; }
    table { border-collapse: collapse; margin-top: 10px; }
    th, td { border: 1px solid #999; padding: 4px 8px; }
    th { background: #eee; }
    .description { font-style: italic; margin: 5px 0; }
  </style>
</head>
<body>
  <h1>Excel Sheet Viewer</h1>
  <input type="file" id="file-input" accept=".xlsx,.xls" />

  <div id="output"></div>

  <script>
    document.getElementById("file-input").addEventListener("change", handleFile, false);

    function handleFile(event) {
      const file = event.target.files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = (e) => {
        const data = new Uint8Array(e.target.result);
        const workbook = XLSX.read(data, { type: "array" });

        const output = document.getElementById("output");
        output.innerHTML = "";

        workbook.SheetNames.forEach((sheetName) => {
          const sheet = workbook.Sheets[sheetName];
          const rows = XLSX.utils.sheet_to_json(sheet, { header: 1, defval: "" });

          if (rows.length < 2) return; // need at least description + headers

          // Row 1 = description
          const description = rows[0][0];

          // Row 2 = table headers
          const headers = rows[1];

          // Rows 3+ = data
          const dataRows = rows.slice(2);

          // Render
          const container = document.createElement("div");
          container.innerHTML = `<h2>${sheetName}</h2>
                                 <div class="description">${description}</div>`;
          const table = document.createElement("table");

          // Header
          const thead = document.createElement("thead");
          const headerRow = document.createElement("tr");
          headers.forEach((h) => {
            const th = document.createElement("th");
            th.textContent = h;
            headerRow.appendChild(th);
          });
          thead.appendChild(headerRow);
          table.appendChild(thead);

          // Body
          const tbody = document.createElement("tbody");
          dataRows.forEach((row) => {
            const tr = document.createElement("tr");
            headers.forEach((_, i) => {
              const td = document.createElement("td");
              td.textContent = row[i] || "";
              tr.appendChild(td);
            });
            tbody.appendChild(tr);
          });
          table.appendChild(tbody);

          container.appendChild(table);
          output.appendChild(container);
        });
      };
      reader.readAsArrayBuffer(file);
    }
  </script>
</body>
</html>
